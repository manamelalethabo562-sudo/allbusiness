<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <title>Vynix Biz • Live Directory</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600&family=Plus+Jakarta+Sans:wght@400;500;600;700&display=swap" rel="stylesheet"/>
  <link href="https://fonts.googleapis.com/icon?family=Material+Symbols+Rounded" rel="stylesheet"/>

  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>

  <style>
    :root {
      --bg-body: #F0F4F9;
      --bg-sidebar: #F0F4F9;
      --bg-surface: #FFFFFF;
      --primary-blue: #4285F4;
      --primary-gradient: linear-gradient(135deg, #4285F4, #D96570);
      --text-main: #1F1F1F;
      --text-secondary: #444746;
      --text-muted: #8E918F;
      --accent-color: #4285F4;
      --sidebar-width: 260px;
      --sidebar-collapsed: 72px;
      --header-height: 70px;
    }

    * { margin:0; padding:0; box-sizing:border-box; -webkit-tap-highlight-color: transparent; }

    body {
      background: var(--bg-body);
      color: var(--text-main);
      font-family: 'Plus Jakarta Sans', sans-serif;
      height: 100vh;
      display: flex;
      overflow: hidden;
    }

    /* ─── Sidebar ────────────────────────────────────────── */
    .sidebar {
      background: var(--bg-sidebar);
      width: var(--sidebar-collapsed);
      display: flex;
      flex-direction: column;
      padding: 24px 12px;
      z-index: 50;
      transition: width 0.3s cubic-bezier(0.2, 0, 0, 1);
    }

    @media(min-width: 769px) {
      .sidebar:hover { width: var(--sidebar-width); }
      .sidebar:not(:hover) .nav-label, .sidebar:not(:hover) .brand-text { opacity: 0; display: none; }
    }

    .brand-logo { margin-bottom: 40px; padding-left: 12px; }

    .nav-list { flex: 1; display: flex; flex-direction: column; gap: 8px; }
    .nav-item {
      display: flex; align-items: center; gap: 16px; padding: 12px 16px; border-radius: 12px;
      color: var(--text-secondary); cursor: pointer; text-decoration: none; white-space: nowrap;
      transition: 0.2s;
    }
    .nav-item:hover { background: rgba(0,0,0,0.03); color: var(--text-main); }
    .nav-item.active { background: white; color: var(--primary-blue); font-weight: 600; box-shadow: 0 4px 12px rgba(0,0,0,0.05); }

    /* ─── Main Content ───────────────────────────────────── */
    .main {
      flex: 1; display: flex; flex-direction: column; position: relative;
      background: #FFFFFF; border-radius: 32px 0 0 32px; margin: 16px 0 16px 0;
      box-shadow: -10px 0 40px rgba(0,0,0,0.03); overflow: hidden;
    }

    .top-bar {
      height: var(--header-height); display: flex; align-items: center; justify-content: flex-end;
      padding: 0 32px; z-index: 10; background: white; width: 100%; gap: 24px;
    }

    .content-scroll { flex: 1; overflow-y: auto; scroll-behavior: smooth; padding-bottom: 60px; }

    .hero-container {
      display: grid; grid-template-columns: 1.2fr 1fr; gap: 40px; padding: 40px 60px;
      background: #F8FAFD; border-radius: 24px; margin: 0 32px 32px;
    }

    .hero-title { font-size: 3.5rem; font-weight: 800; line-height: 1.1; color: #1F1F1F; }
    .hero-title span { color: var(--primary-blue); }

    /* ─── Pricing Section ────────────────────────────────── */
    .pricing-section { padding: 40px 32px; }
    .pricing-grid {
      display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 24px; margin-top: 32px;
    }
    .price-card {
      background: white; padding: 32px; border-radius: 24px; border: 1px solid #EDF2F7;
      transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      position: relative; overflow: hidden;
    }
    .price-card:hover { transform: translateY(-10px); box-shadow: 0 20px 40px rgba(0,0,0,0.08); }
    .price-card h3 { font-size: 1.5rem; margin-bottom: 12px; }
    .price-tag { font-size: 2rem; font-weight: 800; margin-bottom: 24px; }
    .price-features { list-style: none; margin-bottom: 30px; }
    .price-features li { margin-bottom: 12px; font-size: 0.9rem; color: var(--text-secondary); display: flex; align-items: center; gap: 8px; }

    /* ─── Business Grid ────────────────────────────────── */
    .business-grid {
      display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: 24px; padding: 32px;
    }

    /* ─── Footer ────────────────────────────────────────── */
    .footer { padding: 60px 32px 32px; border-top: 1px solid #F0F0F0; margin-top: 40px; }
    .footer-content { display: flex; justify-content: space-between; align-items: center; }
    .social-links { display: flex; gap: 16px; margin-top: 12px; }
    .social-links a { color: var(--primary-blue); text-decoration: none; font-size: 1.2rem; }

    /* Animations */
    @keyframes fadeInUp { from { opacity:0; transform: translateY(20px); } to { opacity:1; transform: translateY(0); } }
    .price-card { animation: fadeInUp 0.6s ease forwards; opacity: 0; }
    .price-card:nth-child(1) { animation-delay: 0.1s; }
    .price-card:nth-child(2) { animation-delay: 0.2s; }
    .price-card:nth-child(3) { animation-delay: 0.3s; }

    @media(max-width: 900px) {
      .hero-container { grid-template-columns: 1fr; text-align: center; }
      .main { border-radius: 0; margin: 0; }
    }
  </style>
</head>
<body>

  <div class="overlay" id="overlay" onclick="closeOverlays()"></div>

  <aside class="sidebar" id="sidebar">
    <div class="brand-logo">
        <h2 style="font-size: 1.4rem; font-weight: 800; display:flex; align-items:center; gap:12px;">
           <span class="material-symbols-rounded" style="color: var(--primary-blue); font-size: 32px;">bolt</span>
           <span class="brand-text">Vynix Biz</span>
        </h2>
    </div>
    <div class="nav-list">
      <div class="nav-item active" id="nav-dir" onclick="switchView('all')"><span class="material-symbols-rounded">grid_view</span><span class="nav-label">Directory</span></div>
      <div class="nav-item" id="nav-cat" onclick="switchView('categories')"><span class="material-symbols-rounded">category</span><span class="nav-label">Categories</span></div>
      <div class="nav-item" id="nav-fav" onclick="switchView('saved')"><span class="material-symbols-rounded">favorite</span><span class="nav-label">Saved Items</span></div>
      <div class="nav-item" onclick="openListModal()"><span class="material-symbols-rounded">add_circle</span><span class="nav-label">Add Business</span></div>
      <div class="nav-item"><span class="material-symbols-rounded">payments</span><span class="nav-label">Pricing</span></div>
      <div class="nav-item"><span class="material-symbols-rounded">settings</span><span class="nav-label">Settings</span></div>
    </div>
    <div style="margin-top: auto;">
      <div class="nav-item" id="authBtnSidebar" onclick="handleAuth()">
        <span class="material-symbols-rounded">logout</span>
        <span class="nav-label">Sign In</span>
      </div>
    </div>
  </aside>

  <main class="main">
    <div class="top-bar">
      <div style="display:flex; align-items:center; gap:8px; color: var(--text-secondary); cursor: pointer;">
        <span class="material-symbols-rounded">mail</span> <span style="font-size:0.9rem; font-weight:500;">Support</span>
      </div>
      <div style="display:flex; align-items:center; gap:8px; color: var(--text-secondary); cursor: pointer;">
        <span class="material-symbols-rounded">language</span> <span style="font-size:0.9rem; font-weight:500;">English</span>
      </div>
      <div class="user-pill" onclick="handleAuth()">
        <div class="user-avatar" id="userAvatar" style="background-image: url('https://ui-avatars.com/api/?name=Guest')"></div>
      </div>
    </div>

    <div class="content-scroll">
      <div class="hero-container">
        <div>
          <h1 class="hero-title">Vynix Biz •<br><span>Live</span> Directory</h1>
          <p style="color:var(--text-secondary); margin: 20px 0; font-size: 1.1rem;">The most reliable way to find, rate, and connect with businesses in your area.</p>
          <div class="search-wrapper" style="margin: 0;">
            <span class="material-symbols-rounded search-icon">search</span>
            <input type="text" class="search-input" id="searchInput" placeholder="Search businesses..." autocomplete="off">
          </div>
        </div>
        <div style="background: #E8F0FE; border-radius: 20px; display: flex; align-items: center; justify-content: center;">
            <span class="material-symbols-rounded" style="font-size: 120px; color: white;">auto_awesome</span>
        </div>
      </div>

      <div class="filter-bar" id="categoryContainer" style="justify-content: flex-start; padding-left: 32px;">
        <div class="category-pill active" onclick="filterCategory('All', this)">All</div>
        <div class="category-pill" onclick="filterCategory('Restaurant', this)">Restaurant</div>
        <div class="category-pill" onclick="filterCategory('Retail', this)">Retail</div>
        <div class="category-pill" onclick="filterCategory('Service', this)">Service</div>
        <div class="category-pill" onclick="filterCategory('Tech', this)">Tech</div>
      </div>

      <div class="business-grid" id="businessGrid"></div>

      <div class="pricing-section">
        <h2 style="font-size: 2rem; font-weight: 700;">Pricing Plans</h2>
        <p style="color: var(--text-secondary);">Choose the best plan for your business growth.</p>
        
        <div class="pricing-grid">
          <div class="price-card">
            <h3>Basic</h3>
            <div class="price-tag">$0<span>/mo</span></div>
            <ul class="price-features">
              <li><span class="material-symbols-rounded" style="color:green; font-size:18px;">check_circle</span> Standard Listing</li>
              <li><span class="material-symbols-rounded" style="color:green; font-size:18px;">check_circle</span> Basic Analytics</li>
              <li><span class="material-symbols-rounded" style="color:green; font-size:18px;">check_circle</span> Community Support</li>
            </ul>
            <button class="action-btn primary" style="width:100%">Get Started</button>
          </div>

          <div class="price-card" style="border: 2px solid var(--primary-blue);">
            <div style="position:absolute; top:12px; right:12px; background:var(--primary-blue); color:white; padding:4px 12px; border-radius:20px; font-size:0.7rem; font-weight:700;">POPULAR</div>
            <h3>Professional</h3>
            <div class="price-tag">$29<span>/mo</span></div>
            <ul class="price-features">
              <li><span class="material-symbols-rounded" style="color:green; font-size:18px;">check_circle</span> Verified Badge</li>
              <li><span class="material-symbols-rounded" style="color:green; font-size:18px;">check_circle</span> Priority Search</li>
              <li><span class="material-symbols-rounded" style="color:green; font-size:18px;">check_circle</span> Advanced Dashboard</li>
            </ul>
            <button class="action-btn primary" style="width:100%; background: var(--primary-blue);">Choose Pro</button>
          </div>

          <div class="price-card">
            <h3>Enterprise</h3>
            <div class="price-tag">$99<span>/mo</span></div>
            <ul class="price-features">
              <li><span class="material-symbols-rounded" style="color:green; font-size:18px;">check_circle</span> Unlimited Listings</li>
              <li><span class="material-symbols-rounded" style="color:green; font-size:18px;">check_circle</span> API Access</li>
              <li><span class="material-symbols-rounded" style="color:green; font-size:18px;">check_circle</span> 24/7 Account Manager</li>
            </ul>
            <button class="action-btn" style="width:100%">Contact Sales</button>
          </div>
        </div>
      </div>

      <footer class="footer">
        <div class="footer-content">
          <div>
            <h3 style="font-weight: 800;">Vynix Biz</h3>
            <p id="greetingName" style="color: var(--text-secondary); margin: 8px 0;">Connecting communities.</p>
            <div class="social-links">
              <a href="#"><span class="material-symbols-rounded">facebook</span></a>
              <a href="#"><span class="material-symbols-rounded">photo_camera</span></a> <a href="#"><span class="material-symbols-rounded">brand_family</span></a> </div>
          </div>
          <div style="text-align: right; color: var(--text-muted); font-size: 0.85rem;">
            &copy; 2026 Vynix Cloud Solutions<br>
            <a href="#" style="color: inherit; margin-right: 12px;">Privacy</a>
            <a href="#" style="color: inherit;">Terms</a>
          </div>
        </div>
      </footer>
    </div>
  </main>

  <script>
    /* ... Keep all existing Javascript logic here ... */
    const firebaseConfig = {
      apiKey: "AIzaSyAojYRIH8FJL5B8yg1b3qxsc29vB3vLC-8",
      authDomain: "allbusiness-596cc.firebaseapp.com",
      projectId: "allbusiness-596cc",
      storageBucket: "allbusiness-596cc.firebasestorage.app",
      messagingSenderId: "665302840524",
      appId: "1:665302840524:web:e9c1078e14bc0de6a87e69",
      measurementId: "G-EMZFX7CE8V"
    };

    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.database();
    const provider = new firebase.auth.GoogleAuthProvider();

    let allBusinesses = [];
    let savedIds = []; 
    let globalRatings = {};
    let currentCategory = 'All';
    let currentView = 'all'; 
    let currentActiveBizId = null;

    const els = {
      grid: document.getElementById('businessGrid'),
      search: document.getElementById('searchInput'),
      sidebar: document.getElementById('sidebar'),
      overlay: document.getElementById('overlay'),
      greeting: document.getElementById('greetingName'),
      avatar: document.getElementById('userAvatar')
    };

    function initDatabaseListener() {
        db.ref('business_ratings').on('value', (snapshot) => {
            globalRatings = snapshot.val() || {};
            filterBusinesses();
        });
        db.ref('businesses').on('value', (snapshot) => {
            const data = snapshot.val();
            allBusinesses = data ? Object.keys(data).map(key => ({ id: key, ...data[key] })) : [];
            filterBusinesses();
        });
    }

    function switchView(view) {
        currentView = view;
        document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
        if(view === 'all') document.getElementById('nav-dir').classList.add('active');
        else if(view === 'categories') document.getElementById('nav-cat').classList.add('active');
        else if(view === 'saved') document.getElementById('nav-fav').classList.add('active');
        filterBusinesses();
    }

    function filterBusinesses() {
        const query = els.search.value.toLowerCase();
        const filtered = allBusinesses.filter(biz => {
            const matchesSearch = biz.name.toLowerCase().includes(query);
            const matchesCat = currentCategory === 'All' || biz.cat === currentCategory;
            const matchesView = currentView === 'all' || savedIds.includes(biz.id);
            return matchesSearch && matchesCat && matchesView;
        });
        renderCards(filtered);
    }

    function getAverageRating(bizId) {
        const ratings = globalRatings[bizId];
        if (!ratings) return { avg: "0.0", count: 0 };
        const values = Object.values(ratings);
        const sum = values.reduce((a, b) => a + b, 0);
        return { avg: (sum / values.length).toFixed(1), count: values.length };
    }

    function createCard(biz) {
        const ratingData = getAverageRating(biz.id);
        const card = document.createElement('div');
        card.className = 'business-card';
        card.innerHTML = `
            <div class="card-img" style="background-image: url('${biz.img}')">
                <span class="card-category">${biz.cat}</span>
            </div>
            <div class="card-body">
                <div class="biz-name">${biz.name}</div>
                <div class="biz-rating"><span class="material-symbols-rounded" style="font-size:16px;">star</span> ${ratingData.avg}</div>
                <div class="biz-info"><span class="material-symbols-rounded" style="font-size:16px">location_on</span>${biz.address}</div>
            </div>`;
        return card;
    }

    function renderCards(data) {
        els.grid.innerHTML = '';
        data.forEach(biz => els.grid.appendChild(createCard(biz)));
    }

    function handleAuth() {
        if(auth.currentUser) auth.signOut().then(() => location.reload());
        else auth.signInWithPopup(provider);
    }

    auth.onAuthStateChanged(user => {
        if (user) {
            els.greeting.innerText = `Welcome back, ${user.displayName.split(' ')[0]}`;
            els.avatar.style.backgroundImage = `url(${user.photoURL})`;
        }
    });

    function filterCategory(cat, btn) {
        currentCategory = cat;
        document.querySelectorAll('.category-pill').forEach(el => el.classList.remove('active'));
        btn.classList.add('active');
        filterBusinesses();
    }

    els.search.addEventListener('input', filterBusinesses);
    initDatabaseListener();
  </script>
</body>
</html>
